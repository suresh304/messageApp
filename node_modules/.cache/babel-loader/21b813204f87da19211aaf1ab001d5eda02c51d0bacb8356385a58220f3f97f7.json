{"ast":null,"code":"import _objectSpread from\"/home/allisuresh/suresh304.github.io/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/home/allisuresh/suresh304.github.io/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/allisuresh/suresh304.github.io/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/allisuresh/suresh304.github.io/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{addDoc,collection,doc,onSnapshot,orderBy,query,Timestamp,updateDoc,where}from\"firebase/firestore\";import React,{useEffect,useState}from\"react\";import{useAuthState}from\"react-firebase-hooks/auth\";import{auth,db}from\"./firebase\";import Message from\"./Message\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Chat(){var _useAuthState=useAuthState(auth),_useAuthState2=_slicedToArray(_useAuthState,1),user=_useAuthState2[0];console.log(user);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),msg=_useState2[0],setMsg=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),msgs=_useState4[0],setMsgs=_useState4[1];var chatstyle={width:\"40%\",height:\"600px\",backgroundColor:\"grey\",borderRadius:\"20px\",overflow:\"scroll\"};var inputstyles={width:\"39%\",height:window.innerHeight-690,backgroundColor:\"smoke-white\",borderRadius:\"8px\",overFlow:\"scroll\"};var addMessage=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var docref;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();setMsg(e.target.value);console.log(e.target.value);if(!(e.code===\"Enter\")){_context.next=12;break;}document.getElementById(\"input\").value=\"\";_context.next=7;return addDoc(collection(db,\"messages\"),{msg:msg,user:user.displayName,uid:user.uid,sentTime:new Date()});case 7:docref=_context.sent;console.log(docref.id);_context.next=11;return updateDoc(docref,{docid:docref.id});case 11:console.log(\"message stored in firebase\");case 12:case\"end\":return _context.stop();}},_callee);}));return function addMessage(_x){return _ref.apply(this,arguments);};}();var textmsg=[];useEffect(function(){var q=query(collection(db,\"messages\"),orderBy(\"sentTime\"));var unsub=onSnapshot(q,function(querySnapshot){var messages=[];querySnapshot.forEach(function(doc){return messages.push(_objectSpread(_objectSpread({},doc.data()),{},{id:doc.id}));});setMsgs(messages);});return function(){return unsub();};},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:chatstyle,children:msgs&&msgs.map(function(m){return/*#__PURE__*/_jsx(Message,{msg:m});})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"input\",style:inputstyles,onKeyUp:function onKeyUp(e){return addMessage(e);}})]});}export default Chat;","map":{"version":3,"names":["addDoc","collection","doc","onSnapshot","orderBy","query","Timestamp","updateDoc","where","React","useEffect","useState","useAuthState","auth","db","Message","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Chat","_useAuthState","_useAuthState2","_slicedToArray","user","console","log","_useState","_useState2","msg","setMsg","_useState3","_useState4","msgs","setMsgs","chatstyle","width","height","backgroundColor","borderRadius","overflow","inputstyles","window","innerHeight","overFlow","addMessage","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","docref","wrap","_callee$","_context","prev","next","preventDefault","target","value","code","document","getElementById","displayName","uid","sentTime","Date","sent","id","docid","stop","_x","apply","arguments","textmsg","q","unsub","querySnapshot","messages","forEach","push","_objectSpread","data","children","style","map","m","type","onKeyUp"],"sources":["/home/allisuresh/suresh304.github.io/src/Chat.js"],"sourcesContent":["import {\n  addDoc,\n  collection,\n  doc,\n  onSnapshot,\n  orderBy,\n  query,\n  Timestamp,\n  updateDoc,\n  where,\n} from \"firebase/firestore\";\nimport React, { useEffect, useState } from \"react\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { auth, db } from \"./firebase\";\nimport Message from \"./Message\";\n\n\nfunction Chat() {\nconst [user] = useAuthState(auth)\nconsole.log(user)\n\n  const [msg, setMsg] = useState(\"\");\n  const [msgs, setMsgs] = useState();\n  const chatstyle = {\n    width: \"40%\",\n    height: \"600px\",\n    backgroundColor: \"grey\",\n    borderRadius: \"20px\",\n    overflow:\"scroll\"\n  };\n  const inputstyles = {\n    width: \"39%\",\n    height: window.innerHeight - 690,\n    backgroundColor: \"smoke-white\",\n    borderRadius: \"8px\",\n    overFlow:\"scroll\"\n  };\n  const addMessage = async (e) => {\n    e.preventDefault();\n    setMsg(e.target.value);\n\n    console.log(e.target.value);\n    if (e.code === \"Enter\") {\n      document.getElementById(\"input\").value=\"\"\n\n    const docref=  await addDoc(collection(db, \"messages\"), {\n        msg: msg,\n        user:user.displayName,\n        uid:user.uid,\n        sentTime: new Date(),\n      });\n      console.log(docref.id)\n      await updateDoc(docref, {\n        docid:docref.id\n      });\n      console.log(\"message stored in firebase\");\n\n    }\n  };\n\n  let textmsg = [];\n  useEffect(() => {\n    const q = query(collection(db, \"messages\"), orderBy(\"sentTime\"));\n    const unsub = onSnapshot(q, (querySnapshot) => {\n      let messages = [];\n      querySnapshot.forEach((doc) =>\n        messages.push({ ...doc.data(), id: doc.id })\n      );\n    setMsgs(messages)\n\n    });\n    return ()=>unsub()\n  }, []);\n\n  return (\n    <>\n      <div style={chatstyle}>\n        {msgs&&msgs.map((m) => (\n          <Message msg={m}/>\n        ))}\n      </div>\n      <input type=\"text\" id=\"input\" style={inputstyles} onKeyUp={(e) => addMessage(e)} />\n    </>\n  );\n}\n\nexport default Chat;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}